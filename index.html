<!-- === TOPBAR: zwijany tylko na mobile, stały na md+ === -->
<div id="topbar"
     class="fixed top-0 left-0 w-full bg-neutral-900/100 backdrop-blur-md text-neutral-100 z-50 shadow-lg
            transition-all duration-300 will-change-transform translate-y-0 md:translate-y-0">
  <div class="max-w-7xl mx-auto px-4 sm:px-8 py-2">
    <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-2 md:gap-0">
      <!-- Logo + nazwa -->
      <div class="flex items-center gap-3 min-w-0">
        <img src="arwo-elektryka-logo.png" alt="ARWO - Elektryka logo"
             class="h-10 sm:h-12 md:h-14 w-auto drop-shadow-md transition-all duration-300" />
        <span class="font-semibold text-base sm:text-lg md:text-xl truncate">ARWO - Elektryka</span>
      </div>

      <!-- Kontakty (kolumna na mobile, rząd na md+) -->
      <div class="w-full md:w-auto flex flex-col md:flex-row md:items-center gap-2 md:gap-4 text-sm md:text-[0.95rem]">
        <a class="inline-flex items-center justify-center gap-1.5 rounded-lg border border-white/10 hover:bg-white/5 px-3 py-2 w-full md:w-auto whitespace-nowrap"
           href="tel:+48579980110">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5l4 1 2 5-2 1a16 16 0 007 7l1-2 5 2 1 4c-7 2-15-6-17-13z"/>
          </svg>
          +48 579 980 110
        </a>
        <a class="inline-flex items-center justify-center gap-1.5 rounded-lg border border-white/10 hover:bg-white/5 px-3 py-2 w-full md:w-auto whitespace-nowrap"
           href="tel:+48607402802">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5l4 1 2 5-2 1a16 16 0 007 7l1-2 5 2 1 4c-7 2-15-6-17-13z"/>
          </svg>
          +48 607 402 802
        </a>
        <a class="inline-flex items-center justify-center gap-1.5 rounded-lg border border-white/10 hover:bg-white/5 px-3 py-2 w-full md:w-auto break-all"
           href="mailto:arwo.elektryka@gmail.com">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16v12H4z"/>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M22 6L12 13 2 6"/>
          </svg>
          <span class="truncate">arwo.elektryka@gmail.com</span>
        </a>
      </div>
    </div>
  </div>
</div>

<script>
  // --- Ustawienia ---
  const MD_BREAKPOINT = 768;        // Tailwind md
  const HIDE_THRESHOLD = 12;        // minimalny ruch (px), by zwinąć/rozwinąć
  const TOP_OPACITY_SCROLL = 50;    // kiedy zmienić krycie topbaru

  // --- Opaque/transparent zależnie od scrolla (jak było) ---
  function applyTopbarScrollState() {
    const topbar = document.getElementById('topbar');
    if (window.scrollY > TOP_OPACITY_SCROLL) {
      topbar.classList.remove('bg-neutral-900/100');
      topbar.classList.add('bg-neutral-900/60','shadow-md');
    } else {
      topbar.classList.remove('bg-neutral-900/60','shadow-md');
      topbar.classList.add('bg-neutral-900/100');
    }
  }

  // --- Dynamiczny padding-top pod faktyczną wysokość topbaru ---
  function setBodyPaddingTop() {
    const topbar = document.getElementById('topbar');
    document.body.style.paddingTop = topbar.offsetHeight + 'px';
  }

  // --- Zwijanie NAGŁÓWKA tylko na mobile ---
  (function mobileCollapsingHeader(){
    const topbar = document.getElementById('topbar');
    let lastY = window.scrollY;
    let ticking = false;

    // pokaż/ukryj (na mobile)
    function showTopbar() {
      topbar.classList.remove('-translate-y-full');
      topbar.classList.add('translate-y-0');
    }
    function hideTopbar() {
      topbar.classList.remove('translate-y-0');
      topbar.classList.add('-translate-y-full');
    }

    // czy mobile wg szerokości (zgodne z Tailwind md)
    function isMobile() {
      return window.innerWidth < MD_BREAKPOINT;
    }

    function onScroll() {
      if (!ticking) {
        window.requestAnimationFrame(() => {
          const y = window.scrollY;

          // zawsze pełna widoczność przy samym topie
          if (y <= 4) {
            showTopbar();
          } else if (isMobile()) {
            const delta = y - lastY;
            if (delta > HIDE_THRESHOLD) {
              // scroll w dół -> chowamy
              hideTopbar();
            } else if (delta < -HIDE_THRESHOLD) {
              // scroll w górę -> pokazujemy
              showTopbar();
            }
          } else {
            // desktop: zawsze widoczny
            showTopbar();
          }

          applyTopbarScrollState();
          lastY = y;
          ticking = false;
        });
        ticking = true;
      }
    }

    // inicjalizacja
    applyTopbarScrollState();
    setBodyPaddingTop();
    window.addEventListener('load', setBodyPaddingTop);
    window.addEventListener('resize', () => {
      // przy zmianie trybu (obrót ekranu / breakpoint) dopasuj stan
      if (isMobile()) {
        // na mobile pokazany przy starcie/resize
        showTopbar();
      } else {
        // na desktopie zawsze pokazany
        showTopbar();
      }
      setBodyPaddingTop();
    });
    new ResizeObserver(setBodyPaddingTop).observe(topbar);
    window.addEventListener('scroll', onScroll, { passive: true });

    // Integracja z przyciskiem "powrót na górę" (jeśli istnieje na stronie)
    const scrollBtn = document.getElementById('scrollTopBtn');
    if (scrollBtn) {
      scrollBtn.addEventListener('click', () => {
        window.scrollTo({ top: 0, behavior: 'smooth' });
        // pokaż pasek od razu (nie czekając aż scroll zakończy animację)
        showTopbar();
      }, { passive: true });
    }

    // wystartuj w poprawnym stanie
    onScroll();
  })();
</script>

<style>
  /* Upewniamy się, że body nie ma stałego padding-top z poprzednich wersji */
  html { scroll-behavior: smooth; }
  body { padding-top: 0; }
</style>
